<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Traffic Analysis</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    /* Custom styles (glassmorphism, dark theme) */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0a1e33, #112d4e, #1f4068);
      color: #e0e6f1;
      text-align: center;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      background: url('https://www.transparenttextures.com/patterns/cubes.png');
      opacity: 0.07;
      z-index: 0;
    }
    header {
      padding: 24px 20px;
      background: rgba(255 255 255 / 0.05);
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      position: relative;
      z-index: 1;
      font-weight: 700;
      font-size: 2.2rem;
      letter-spacing: 1.1px;
      color: #cdd6f4;
      text-shadow: 0 1px 3px rgba(0,0,0,0.6);
    }
    .intro {
      font-size: 1.1rem;
      margin-bottom: 25px;
      color: #aab8d3;
      line-height: 1.5;
      user-select: none;
    }
    /* Glassmorphism pollution card */
    .pollution-card {
      background: rgba(255 255 255 / 0.15);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      box-shadow:
        0 8px 32px 0 rgba(31, 38, 135, 0.37);
      padding: 32px 40px;
      text-align: left;
      font-weight: 600;
      font-size: 1.18rem;
      color: #e0e6f1;
      border: 1px solid rgba(255 255 255 / 0.18);
      user-select: none;
      transition: box-shadow 0.3s ease;
      max-width: 480px;
      margin: 0 auto 2rem auto;
    }
    .pollution-card:hover {
      box-shadow:
        0 12px 48px 0 rgba(31, 38, 135, 0.6);
    }
    .pollution-card h2 {
      margin-top: 0;
      font-size: 2.0rem;
      letter-spacing: 1.2px;
      margin-bottom: 26px;
      color: #e9ecef;
      text-align: center;
      text-shadow: 0 2px 6px rgba(15, 31, 64, 0.7);
    }
    .pollution-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      gap: 12px;
      flex-wrap: wrap;
    }
    .pollution-item span {
      font-weight: 600;
      color: #cbd5e1;
    }
    .pollution-item strong {
      font-size: 1.4rem;
      white-space: nowrap;
      min-width: 140px;
      text-align: right;
      color: #f9fafb;
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    }
    /* Updating animation */
    @keyframes pulse {
      0% { background-color: rgba(255 255 255 / 0.15); }
      50% { background-color: rgba(255 255 255 / 0.35); }
      100% { background-color: rgba(255 255 255 / 0.15); }
    }
    .updating {
      animation: pulse 1.5s ease-in-out;
      border-radius: 8px;
      padding: 4px 10px;
    }
    /* Chart wrapper with glass style */
    .chart-wrapper {
      max-width: 480px;
      margin: 0 auto 2rem auto;
      padding: 24px 30px;
      background: rgba(255 255 255 / 0.12);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      box-shadow:
        0 8px 30px 0 rgba(31, 38, 135, 0.4);
      position: relative;
      user-select: none;
    }
    #pollutionChart {
      width: 100% !important;
      height: 280px !important;
    }
    .back-btn {
      display: inline-block;
      margin-top: 34px;
      padding: 14px 30px;
      background: #4c8bf5;
      color: white;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      border-radius: 8px;
      transition: background 0.3s ease, transform 0.15s ease;
      box-shadow: 0 4px 14px rgba(76, 139, 245, 0.6);
      user-select: none;
    }
    .back-btn:hover {
      background: #3a6fd1;
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(58, 111, 209, 0.8);
    }
    /* Landscape comparison */
    .landscape-comparison {
      margin-top: 60px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      background: rgba(255 255 255 / 0.12);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 32px 40px;
      color: #e0e6f1;
      user-select: none;
      position: relative;
    }
    .landscape-comparison h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #cbd5e1;
    }
    #landscapeChart {
      max-height: 400px;
      width: 100% !important;
      height: 400px !important;
    }
    .no-pollution-icon {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(79, 154, 255, 0.2);
      padding: 8px 12px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 1rem;
      color: #4f9aff;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease, transform 0.3s ease, color 0.3s ease;
      z-index: 10;
    }
    .no-pollution-icon svg {
      flex-shrink: 0;
      transition: transform 0.3s ease;
    }
    .no-pollution-icon:hover,
    .no-pollution-icon:focus {
      background: rgba(31, 64, 255, 0.4);
      color: #1a6fff;
      outline: none;
      transform: scale(1.05);
    }
    .no-pollution-icon:hover svg,
    .no-pollution-icon:focus svg {
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <header>Traffic Analysis</header>

  <main class="container my-4">
    <p class="intro mx-auto">
      Below are real-world snapshots of urban traffic congestion. These visuals highlight how heavy traffic contributes to air pollution and affects city life.
    </p>

    <!-- Responsive Image Grid with Bootstrap -->
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4" role="list">
      <div class="col" role="listitem">
        <img
          src="https://media.istockphoto.com/id/1247667822/photo/traffic-jam-with-cars-mopeds-and-auto-rickshaws-in-a-road-in-new-delhi-in-india.jpg?s=612x612&w=0&k=20&c=l73s2l1WyBVp71x9iveOffwt5-U7rox6mamt1tdh6-U="
          alt="Traffic jam in New Delhi"
          class="img-fluid rounded shadow"
          loading="lazy"
        />
      </div>
      <div class="col" role="listitem">
        <img
          src="https://media.istockphoto.com/id/1126419555/photo/blurred-silhouettes-of-cars-surrounded-by-steam-from-the-exhaust-pipes.jpg?s=612x612&w=0&k=20&c=KJar2L5PPFRtntaAuJdWNtCWdhtI2f3y0Y212GSk1wQ="
          alt="Cars emitting exhaust steam"
          class="img-fluid rounded shadow"
          loading="lazy"
        />
      </div>
      <div class="col" role="listitem">
        <img
          src="https://media.istockphoto.com/id/537061697/photo/power-station-chimneys.jpg?s=612x612&w=0&k=20&c=kxYOiXUfrBa5NhmIJojquj0Tcoa7ncc8MBoLPK2qEs8="
          alt="Power station chimneys"
          class="img-fluid rounded shadow"
          loading="lazy"
        />
      </div>
    </div>

    <!-- Pollution tracker and chart side by side on md+ screens, stacked on small -->
    <div class="row align-items-start mt-5">
      <div class="col-md-6">
        <section
          class="pollution-card"
          id="pollutionCard"
          aria-live="polite"
          aria-atomic="true"
          aria-label="Pollution Tracker"
        >
          <h2>Pollution Tracker</h2>
          <div class="pollution-item">
            <span>Air Quality Index:</span> <strong id="aqiValue">85 (Moderate)</strong>
          </div>
          <div class="pollution-item">
            <span>COâ‚‚ Levels:</span> <strong id="co2Value">410 ppm</strong>
          </div>
          <div class="pollution-item">
            <span>Last Updated:</span> <strong id="lastUpdated">--:--</strong>
          </div>
        </section>
      </div>
      <div class="col-md-6">
        <div
          class="chart-wrapper"
          aria-label="Pollution levels chart"
          role="region"
          aria-live="polite"
        >
          <canvas id="pollutionChart" role="img" aria-describedby="chartDesc"></canvas>
          <div id="chartDesc" class="visually-hidden">
            Bar chart showing Air Quality Index and CO2 levels
          </div>
        </div>
      </div>
    </div>

    <!-- Landscape Quality Comparison -->
    <section class="landscape-comparison mt-5 position-relative" aria-label="Comparison of Pollution Indicators for Landscapes">
      <a href="no-pollution-places.html" title="View Places with No Pollution" aria-label="No Pollution Areas" class="no-pollution-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#4f9aff" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm0 18a8 8 0 0 1 0-16zm0-14a6 6 0 0 0 0 12z"/>
        </svg>
        <span>No Pollution Areas</span>
      </a>
      <h2>Landscape Quality Comparison</h2>
      <canvas id="landscapeChart" role="img" aria-describedby="landscapeChartDesc"></canvas>
      <div id="landscapeChartDesc" class="visually-hidden">
        Radar chart comparing pollution indicators for Polluted Landscape and Healthy Landscape
      </div>
    </section>

    <a href="index.html" class="back-btn btn btn-primary mt-4">Back to Dashboard</a>
  </main>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    // Pollution Chart & update logic (unchanged)
    function getAQIStatus(aqi) {
      if (aqi <= 50) return "Good";
      if (aqi <= 100) return "Moderate";
      if (aqi <= 150) return "Unhealthy for Sensitive Groups";
      if (aqi <= 200) return "Unhealthy";
      if (aqi <= 300) return "Very Unhealthy";
      return "Hazardous";
    }

    const ctx = document.getElementById('pollutionChart').getContext('2d');
    const pollutionChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Air Quality Index', 'COâ‚‚ Levels (ppm)'],
        datasets: [{
          label: 'Pollution Levels',
          data: [85, 410],
          backgroundColor: ['#4f9aff', '#1de9b6'],
          borderRadius: 8,
          borderSkipped: false,
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            max: 600,
            ticks: {
              stepSize: 50,
              color: '#cdd6f4',
              font: { weight: '600' }
            },
            grid: {
              color: 'rgba(205, 214, 244, 0.2)',
            }
          },
          x: {
            ticks: {
              color: '#cdd6f4',
              font: { weight: '600' }
            },
            grid: {
              display: false,
            }
          }
        },
        plugins: {
          legend: {
            display: false,
          },
          tooltip: {
            enabled: true,
            backgroundColor: '#1f4068',
            titleColor: '#e0e6f1',
            bodyColor: '#e0e6f1',
            cornerRadius: 6,
            padding: 10,
            bodyFont: { weight: '600' }
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        animation: {
          duration: 600,
          easing: 'easeOutQuart',
        }
      }
    });

    function updatePollutionData() {
      const aqiEl = document.getElementById('aqiValue');
      const co2El = document.getElementById('co2Value');
      const updatedEl = document.getElementById('lastUpdated');
      const card = document.getElementById('pollutionCard');

      card.classList.add('updating');

      const newAQI = Math.floor(50 + Math.random() * 150);
      const newCO2 = Math.floor(350 + Math.random() * 120);
      const now = new Date();
      const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

      setTimeout(() => {
        pollutionChart.data.datasets[0].data = [newAQI, newCO2];
        pollutionChart.update();

        aqiEl.textContent = `${newAQI} (${getAQIStatus(newAQI)})`;
        co2El.textContent = `${newCO2} ppm`;
        updatedEl.textContent = timeStr;

        card.classList.remove('updating');
      }, 1200);
    }

    setInterval(updatePollutionData, 20000);
    updatePollutionData();

    // Landscape Radar Chart
    const landscapeCtx = document.getElementById('landscapeChart').getContext('2d');
    const landscapeChart = new Chart(landscapeCtx, {
      type: 'radar',
      data: {
        labels: ['AQI', 'COâ‚‚ ppm', 'Noise Level dB', 'Green Coverage %', 'Water Quality'],
        datasets: [
          {
            label: 'Polluted Landscape',
            data: [160, 520, 85, 10, 20],
            fill: true,
            backgroundColor: 'rgba(244, 67, 54, 0.3)',
            borderColor: '#f44336',
            pointBackgroundColor: '#f44336',
            pointHoverRadius: 8,
            borderWidth: 2,
          },
          {
            label: 'Healthy Landscape',
            data: [35, 320, 55, 75, 90],
            fill: true,
            backgroundColor: 'rgba(76, 175, 80, 0.3)',
            borderColor: '#4caf50',
            pointBackgroundColor: '#4caf50',
            pointHoverRadius: 8,
            borderWidth: 2,
          }
        ]
      },
      options: {
        scales: {
          r: {
            angleLines: { color: '#8e99a8' },
            grid: { color: '#8e99a8' },
            pointLabels: { color: '#cbd5e1', font: { size: 14, weight: '600' } },
            ticks: { display: false, beginAtZero: true, max: 600 },
          }
        },
        plugins: {
          legend: {
            labels: {
              color: '#cbd5e1',
              font: { weight: '700' }
            },
            position: 'top',
          },
          tooltip: {
            enabled: true,
            backgroundColor: '#1f4068',
            titleColor: '#e0e6f1',
            bodyColor: '#e0e6f1',
            cornerRadius: 6,
            padding: 10,
          }
        },
        responsive: true,
        maintainAspectRatio: false,
        animation: {
          duration: 700,
          easing: 'easeOutQuad',
        }
      }
    });
  </script>

  <!-- Bootstrap JS Bundle (Popper included, for any future needs) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
